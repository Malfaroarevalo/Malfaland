<!DOCTYPE html>
<html>
<head>
    <title>World Map</title>
    <style>
        /* Define the styles for the map */
        .map-container {
            width: 100%;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }
        
        .map {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }
        
        /* Define the styles for the character */
        .character {
            width: 40px;
            height: 40px;
            position: absolute;
            transition: top 0.5s ease, left 0.5s ease;
            z-index: 1;
            background-image: url('player1.jpg');
        }
        
        /* Define the styles for the events */
        .event {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px;
            display: none;
        }
        
        /* Define the styles for the enemy */
        .enemy {
            width: 40px;
            height: 40px;
            position: absolute;
            z-index: 0;
            background-image: url('enemy.jpg');
        }
        
        /* Define the styles for the battle scene */
        .battle {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: white;
            z-index: 2;
            display: none;
        }
        
        /* Add more event styles as needed */
        
        /* Define the styles for the road */
        .road {
            width: 40px;
            height: 40px;
            position: absolute;
            z-index: 0;
            background-color: gray;
        }
    </style>
    <script>
        // JavaScript code for character movement and events
        
        // Variable to keep track of the map dimensions
        var mapWidth = 200; // Width of the map (in virtual units)
        var mapHeight = 100; // Height of the map (in virtual units)
        
        // Variable to keep track of the character position
        var characterPosition = { top: 100, left: 200 };
        
        // Variable to keep track of the number of steps taken
        var stepsTaken = 0;
        
        // Variable to keep track of the enemy position
        var enemyPosition = { top: 0, left: 0 };
        
        // Variable to store the road locations
        var roadLocations = [];
        
        // Variable to keep track of the road construction mode
        var isRoadConstructionMode = false;
        
        // Function to move the character
        function moveCharacter(top, left) {
            var character = document.getElementById('character');
            character.style.top = top + 'px';
            character.style.left = left + 'px';
        }
        
        // Function to handle events after a certain number of steps
        function handleEvents() {
            stepsTaken++;
            
            // Check if an event should be triggered
            if (stepsTaken % 10 === 0) {
                // Check if the character has encountered an enemy
                if (characterPosition.top === enemyPosition.top && characterPosition.left === enemyPosition.left) {
                    // Prompt the user to enter the battle scene
                    var confirmBattle = confirm('Do you want to enter the battle scene?');
                    
                    if (confirmBattle) {
                        startBattle();
                    }
                }
            }
        }
        
        // Function to rest and recover
        function rest() {
            // Perform rest actions here, such as recovering HP or stamina
            
            // Hide the battle scene
            document.getElementById('battle').style.display = 'none';
        }
        
        // Function to continue moving
        function continueMoving() {
            // Perform actions when choosing to keep moving, such as reducing HP or stamina
            
            // Hide the battle scene
            document.getElementById('battle').style.display = 'none';
        }
        
        // Function to attack the enemy
        function attack() {
            // TODO: Implement the attack function
        }
        
        // Function to defend against the enemy
        function defend() {
            // TODO: Implement the defend function
        }
        
        // Function to run away from the enemy
        function run() {
            // TODO: Implement the run function
        }
        
        // Function to handle character movement based on key presses
        function handleKeyPress(event) {
            var character = document.getElementById('character');
            
            // Get current character position
            var top = characterPosition.top;
            var left = characterPosition.left;
            
            // Handle arrow key presses
            switch (event.key) {
                case 'ArrowUp':
                    if (top > 0) top -= 20;
                    break;
                case 'ArrowDown':
                    if (top < (mapHeight - 1) * 20) top += 20;
                    break;
                case 'ArrowLeft':
                    if (left > 0) left -= 20;
                    break;
                case 'ArrowRight':
                    if (left < (mapWidth - 1) * 20) left += 20;
                    break;
            }
            
            // Update character position
            characterPosition.top = top;
            characterPosition.left = left;
            
            // Move the character on the map
            moveCharacter(top, left);
            
            // Handle events after a certain number of steps
            handleEvents();
        }
        
        // Function to handle character movement based on mouse clicks
        function handleMouseClick(event) {
            var character = document.getElementById('character');
            
            // Get current character position
            var top = characterPosition.top;
            var left = characterPosition.left;
            
            // Handle left mouse click
            if (event.button === 0) {
                // Move character to the clicked position
                top = event.clientY - 20;
                left = event.clientX - 20;
                
                // Update character position
                characterPosition.top = top;
                characterPosition.left = left;
                
                // Move the character on the map
                moveCharacter(top, left);
                
                // Handle events after a certain number of steps
                handleEvents();
            }
            
            // Handle right mouse click
            if (event.button === 2) {
                // Show character menu or inventory
                var characterMenu = document.getElementById('characterMenu');
                characterMenu.style.display = 'block';
                characterMenu.style.top = event.clientY + 'px';
                characterMenu.style.left = event.clientX + 'px';
            }
        }
        
        // Function to toggle road construction mode
        function toggleRoadConstructionMode() {
            isRoadConstructionMode = !isRoadConstructionMode;
            
            // Update UI based on road construction mode
            var roadConstructionButton = document.getElementById('roadConstructionButton');
            roadConstructionButton.classList.toggle('active', isRoadConstructionMode);
        }
    </script>
</head>
<body>
    <div class="map-container">
        <div class="map" id="map" oncontextmenu="return false"></div>
        <div class="character" id="character"></div>
    </div>
    
    <div class="event" id="battle">
        <button onclick="attack()">Attack</button>
        <button onclick="defend()">Defend</button>
        <button onclick="run()">Run</button>
    </div>
    
    <div class="event" id="characterMenu">
        <!-- Add options for character menu or inventory -->
    </div>
    
    <button id="roadConstructionButton" onclick="toggleRoadConstructionMode()">Road Construction Mode</button>
    
    <script>
        // Generate the world map
        var mapElement = document.getElementById('map');
        mapElement.style.backgroundImage = "url('world.jpg')";
        
        // Generate road layer
        var roadLayer = document.createElement('div');
        roadLayer.style.width = mapWidth * 40 + 'px';
        roadLayer.style.height = mapHeight * 40 + 'px';
        roadLayer.style.position = 'absolute';
        roadLayer.style.zIndex = '0';
        mapElement.appendChild(roadLayer);
        
        // Generate encounter layer
        var encounterLayer = document.createElement('div');
        encounterLayer.style.width = mapWidth * 40 + 'px';
        encounterLayer.style.height = mapHeight * 40 + 'px';
        encounterLayer.style.position = 'absolute';
        encounterLayer.style.zIndex = '0';
        mapElement.appendChild(encounterLayer);
        
        // Function to generate a road element
        function generateRoadElement(top, left) {
            var roadElement = document.createElement('div');
            roadElement.className = 'road';
            roadElement.style.top = top + 'px';
            roadElement.style.left = left + 'px';
            return roadElement;
        }
        
        // Function to generate an encounter element
        function generateEncounterElement(top, left) {
            var encounterElement = document.createElement('div');
            encounterElement.className = 'enemy';
            encounterElement.style.top = top + 'px';
            encounterElement.style.left = left + 'px';
            return encounterElement;
        }
        
        // Generate roads and encounters
        for (var i = 0; i < mapHeight; i++) {
            for (var j = 0; j < mapWidth; j++) {
                var roadElement = generateRoadElement(i * 40, j * 40);
                roadLayer.appendChild(roadElement);
                
                // Add road location to roadLocations array
                roadLocations.push({ top: i * 40, left: j * 40 });
                
                // Generate encounters at random positions
                if (Math.random() < 0.1) {
                    var encounterElement = generateEncounterElement(i * 40, j * 40);
                    encounterLayer.appendChild(encounterElement);
                }
            }
        }
        
        // Set initial character position
        moveCharacter(characterPosition.top, characterPosition.left);
        
        // Add event listeners
        document.addEventListener('keydown', handleKeyPress);
        document.addEventListener('click', handleMouseClick);
    </script>
</body>
</html>
